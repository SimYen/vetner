<div class="container" style="margin-top: 1rem; margin-bottom: 3rem;">
  <div class="row">
    <div class="col">
      <%= form_with(model: pet, local: true) do |form| %>
        <!-- pet profile image -->
        <!-- show default image if no image has been uploaded -->
        <% if pet.image.attached? %>
          <img src=<%= (url_for(pet.image)) %> alt="" width="128" class="my-2" id="profileImage">
        <% else %>
          <img src=<%= image_url "defaultAnimal.png" %> alt="" width="128" class="my-2" id="profileImage">
        <% end %>

        <div class="input-group mb-3">
          <div class="custom-file">
            <%= form.file_field :image, class: "custom-file-input" %>
            <%= form.label :image, 'Choose a file', class: "custom-file-label" %>
          </div>
        </div>

        <div class="form-group row">
          <%= form.label :name, 'Name', class: "col-sm-2 col-form-label" %>
          <div class="col-sm-10">
            <%= form.text_field :name, class: "form-control", required: true %>
          </div>
        </div>
        <div class="form-group row">
          <%= form.label :pet_type, 'Type', class: "col-sm-2 col-form-label" %>
          <div class="col-sm-10">
            <%= form.select :pet_type, options_for_select([["Cat", "Cat"], ["Dog", "Dog"]], selected: pet.pet_type), {include_blank: 'Select'}, {required: true, autofocus: false, class: 'form-control'} %>
          </div>
        </div>

        <div class="form-group row">
          <%= form.label :date_of_birth, 'Date of birth', class: "col-sm-2 col-form-label" %>
          <div class="col-sm-10">
            <%= form.date_select :date_of_birth, {
                :order => [:day, :month, :year],
                :start_year => 1990
               },
               {:class => "form-control my-2"} %>
          </div>
        </div>

        <div class="form-group row">
          <%= form.label :breed, 'Breed', class: "col-sm-2 col-form-label" %>
          <div class="col-sm-10">
            <%= form.text_field :breed, class: "form-control", required: true %>
          </div>
        </div>

        <div class="form-group row">
          <div class="col-sm-10">
              <%= form.submit class: "btn btn-primary" %>
          </div>
        </div>
        
      <% end %>
    </div>
  </div>
</div>

<!-- script for displaying the newly uploaded profile image and filename -->
<script>
  $('#pet_image').on('change',function(event){
    // get the file info
    var files = event.target.files;
    var image = files[0];

    // replace the "Choose a file" label with the file name
    $(this).next('.custom-file-label').html(image.name);

    // show the new image
    var reader = new FileReader();

    reader.onload = function(file) {
      var img = $("#profileImage")[0];
      img.src = file.target.result;
    }

    reader.readAsDataURL(image);
  });
</script>
